<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>MAPPING VTC</title>
	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
	<link rel="stylesheet" href="../assets/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i">
	<link rel="stylesheet" href="../assets/css/ready.css">
	<link rel="stylesheet" href="../assets/css/demo.css">
	
	<!-- my leaflet inports -->
	<link rel="stylesheet" href="../css/leaflet.css">
        <link rel="stylesheet" href="../css/qgis2web.css"><link rel="stylesheet" href="../css/fontawesome-all.min.css">
        <link rel="stylesheet" href="../css/MarkerCluster.css">
        <link rel="stylesheet" href="../css/MarkerCluster.Default.css">
        <link rel="stylesheet" href="../css/leaflet-control-geocoder.Geocoder.css">
		<link rel="stylesheet" href="../css/leaflet-measure.css">
		
	<!-- my custom style -->
	<style>
        html, body, #map {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
        </style>

</head>
<body>
	<div class="wrapper">
		<div class="main-header">
			<div class="logo-header">
				<a href="index.html" class="logo">
					Mapping VTC
				</a>
				<button class="navbar-toggler sidenav-toggler ml-auto" type="button" data-toggle="collapse" data-target="collapse" aria-controls="sidebar" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<button class="topbar-toggler more"><i class="la la-ellipsis-v"></i></button>
			</div>
			
			</div>
			<div class="sidebar">
				<div class="scrollbar-inner sidebar-wrapper">
					<ul class="nav">


						<!-- my images should occupy this area -->


						<!-- <li class="nav-item active">
							<a href="index.html">
								<i class="la la-dashboard"></i>
								<p>Dashboard</p>
								<span class="badge badge-count">5</span>
							</a>
						</li> -->
						
					</ul>
				</div>
			</div>
			<div class="main-panel">
				<div class="content">
					<div class="container-fluid">
						<h4 class="page-title">Dashboard</h4>
						<div class="row">
							<div class="col-md-4">
								<div class="card card-stats card-warning">
									<div class="card-body ">
										<div class="row">
											<div class="col-5">
												<div class="icon-big text-center">
													<i class="fa fa-university"></i>
												</div>
											</div>
											<div class="col-7 d-flex align-items-center">
												<div class="numbers">
													<p class="card-category">Need of support but eliminated</p>
													<h4 class="card-title" id="need">3</h4>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<div class="card card-stats card-success">
									<div class="card-body ">
										<div class="row">
											<div class="col-5">
												<div class="icon-big text-center">
													<i class="fa fa-university"></i>
												</div>
											</div>
											<div class="col-7 d-flex align-items-center">
												<div class="numbers">
													<p class="card-category">Qualify for support</p>
													<h4 class="card-title" id="qualify">3</h4>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<div class="card card-stats card-danger">
									<div class="card-body">
										<div class="row">
											<div class="col-5">
												<div class="icon-big text-center">
													<i class="fa fa-university"></i>
												</div>
											</div>
											<div class="col-7 d-flex align-items-center">
												<div class="numbers">
													<p class="card-category">Not to be considered for support</p>
													<h4 class="card-title" id="considered">8</h4>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							
						</div>
						<div class="row">
							<div class="col-md-12">
								<div class="card">
									<div class="card-header">
										<h4 class="card-title">Western Region</h4>
										<p class="card-category">
										Distribution of Vocational Training Centers</p>
									</div>
									<div class="card-body">
										<div  id="map">
										<!-- <div class="mapcontainer"  id="map"> -->
											<div class="map" style="height: 600px;">
												<span>Alternative content for the map</span>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						
						
					</div>
				</div>
				<footer class="footer">
					<div class="container-fluid">
						<nav class="pull-left">
							<ul class="nav">
								<li class="nav-item">
									<a class="nav-link" href="http://geomird.co.ke">
										geomird
									</a>
								</li>
								
							</ul>
						</nav>
						<div class="copyright ml-auto">
							2021, made by <a href="https://www.geomird.ke">geomird</a>
						</div>				
					</div>
				</footer>
			</div>
		</div>
	</div>
	
	<script src="../js/qgis2web_expressions.js"></script>
	<script src="../js/leaflet.js"></script>
	<script src="../js/leaflet-svg-shape-markers.min.js"></script>
	<script src="../js/leaflet.rotatedMarker.js"></script>
	<script src="../js/leaflet.pattern.js"></script>
	<script src="../js/leaflet-hash.js"></script>
	<script src="../js/Autolinker.min.js"></script>
	<script src="../js/rbush.min.js"></script>
	<script src="../js/labelgun.min.js"></script>
	<script src="../js/labels.js"></script>
	<script src="../js/leaflet-control-geocoder.Geocoder.js"></script>
	<script src="../js/leaflet-measure.js"></script>
	<script src="../js/leaflet.markercluster.js"></script>
	<script src="../data/vtc_01_1.js"></script>
	<script>
	var highlightLayer;
	function highlightFeature(e) {
		highlightLayer = e.target;

		if (e.target.feature.geometry.type === 'LineString') {
		  highlightLayer.setStyle({
			color: '#ffff00',
		  });
		} else {
		  highlightLayer.setStyle({
			fillColor: '#ffff00',
			fillOpacity: 1
		  });
		}
		highlightLayer.openPopup();
	}
	var map = L.map('map', {
		zoomControl:true, maxZoom:28, minZoom:1
	}).fitBounds([[-0.5202839593750064,33.501681374479155],[0.5646410385416714,34.97832787447917]]);
	var hash = new L.Hash(map);
	map.attributionControl.setPrefix('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a> &middot; <a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> &middot; <a href="https://qgis.org">QGIS</a>');
	var autolinker = new Autolinker({truncate: {length: 30, location: 'smart'}});
	var measureControl = new L.Control.Measure({
		position: 'topleft',
		primaryLengthUnit: 'meters',
		secondaryLengthUnit: 'kilometers',
		primaryAreaUnit: 'sqmeters',
		secondaryAreaUnit: 'hectares'
	});
	measureControl.addTo(map);
	document.getElementsByClassName('leaflet-control-measure-toggle')[0]
	.innerHTML = '';
	document.getElementsByClassName('leaflet-control-measure-toggle')[0]
	.className += ' fas fa-ruler';
	var bounds_group = new L.featureGroup([]);
	function setBounds() {
	}
	map.createPane('pane_OpenStreetMap_0');
	map.getPane('pane_OpenStreetMap_0').style.zIndex = 400;
	var layer_OpenStreetMap_0 = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
		pane: 'pane_OpenStreetMap_0',
		opacity: 1.0,
		attribution: '',
		minZoom: 1,
		maxZoom: 28,
		minNativeZoom: 0,
		maxNativeZoom: 19
	});
	layer_OpenStreetMap_0;
	map.addLayer(layer_OpenStreetMap_0);
	function pop_vtc_01_1(feature, layer) {
		layer.on({
			mouseout: function(e) {
				for (i in e.target._eventParents) {
					e.target._eventParents[i].resetStyle(e.target);
				}
				if (typeof layer.closePopup == 'function') {
					layer.closePopup();
				} else {
					layer.eachLayer(function(feature){
						feature.closePopup()
					});
				}
			},
			mouseover: highlightFeature,
		});
		// <img src='"+entry[0]+"&previewImage=true'</img>
		var popupContent =
		 '<table>\
				<tr>\
					<th scope="row">Image</th>\
					<td><img class="card-img-top" src='+feature.properties['image_url']+'> </td>\
				</tr>\
				<tr>\
					<th scope="row">Name</th>\
					<td>' + (feature.properties['name'] !== null ? autolinker.link(feature.properties['name'].toLocaleString()) : '') + '</td>\
				</tr>\
				<tr>\
					<th scope="row">County</th>\
					<td>' + (feature.properties['county'] !== null ? autolinker.link(feature.properties['county'].toLocaleString()) : '') + '</td>\
				</tr>\
				<tr>\
					<th scope="row">Contact <br> person</th>\
					<td>' + (feature.properties['contact pe'] !== null ? autolinker.link(feature.properties['contact pe'].toLocaleString()) : '') + '</td>\
				</tr>\
				<tr>\
					<th scope="row">rank</th>\
					<td>' + (feature.properties['rank'] !== null ? autolinker.link(feature.properties['rank'].toLocaleString()) : '') + '</td>\
				</tr>\
				<tr>\
					<th scope="row">Phone</th>\
					<td>' + (feature.properties['phone'] !== null ? autolinker.link(feature.properties['phone'].toLocaleString()) : '') + '</td>\
				</tr>\
				<tr>\
					<th scope="row">Email</th>\
					<td>' + (feature.properties['email'] !== null ? autolinker.link(feature.properties['email'].toLocaleString()) : '') + '</td>\
				</tr>\
			</table>';
		layer.bindPopup(popupContent, {maxHeight: 400});
	}

	function style_vtc_01_1_0(feature) {
		switch(String(feature.properties['color code'])) {
			case 'green':
				return {
			pane: 'pane_vtc_01_1',
			shape: 'diamond',
			radius: 8.8,
			opacity: 1,
			color: 'rgba(61,128,53,1.0)',
			dashArray: '',
			lineCap: 'butt',
			lineJoin: 'miter',
			weight: 2.0,
			fill: true,
			fillOpacity: 1,
			fillColor: 'rgba(84,176,74,1.0)',
			interactive: true,
		}
				break;
			case 'Orange':
				return {
			pane: 'pane_vtc_01_1',
			radius: 8.0,
			opacity: 1,
			color: 'rgba(179,92,21,1.0)',
			dashArray: '',
			lineCap: 'butt',
			lineJoin: 'miter',
			weight: 2.0,
			fill: true,
			fillOpacity: 1,
			fillColor: 'rgba(247,128,30,1.0)',
			interactive: true,
		}
				break;
			case 'red':
				return {
			pane: 'pane_vtc_01_1',
			shape: 'diamond',
			radius: 8.8,
			opacity: 1,
			color: 'rgba(128,17,25,1.0)',
			dashArray: '',
			lineCap: 'butt',
			lineJoin: 'miter',
			weight: 2.0,
			fill: true,
			fillOpacity: 1,
			fillColor: 'rgba(219,30,42,1.0)',
			interactive: true,
		}
				break;
		}
	
	}
	map.createPane('pane_vtc_01_1');
	map.getPane('pane_vtc_01_1').style.zIndex = 401;
	map.getPane('pane_vtc_01_1').style['mix-blend-mode'] = 'normal';
	var layer_vtc_01_1 = new L.geoJson(json_vtc_01_1, {
		attribution: '',
		interactive: true,
		dataVar: 'json_vtc_01_1',
		layerName: 'layer_vtc_01_1',
		pane: 'pane_vtc_01_1',
		onEachFeature: pop_vtc_01_1,
		pointToLayer: function (feature, latlng) {
			var context = {
				feature: feature,
				variables: {}
			};
			return L.shapeMarker(latlng, style_vtc_01_1_0(feature));
		},
	});
	var cluster_vtc_01_1 = new L.MarkerClusterGroup({showCoverageOnHover: false,
		spiderfyDistanceMultiplier: 2});
	cluster_vtc_01_1.addLayer(layer_vtc_01_1);

	bounds_group.addLayer(layer_vtc_01_1);
	cluster_vtc_01_1.addTo(map);
	var osmGeocoder = new L.Control.Geocoder({
		collapsed: true,
		position: 'topleft',
		text: 'Search',
		title: 'Testing'
	}).addTo(map);
	document.getElementsByClassName('leaflet-control-geocoder-icon')[0]
	.className += ' fa fa-search';
	document.getElementsByClassName('leaflet-control-geocoder-icon')[0]
	.title += 'Search for a place';
	var baseMaps = {};
	L.control.layers(baseMaps,{'vtc_01<br /><table><tr><td style="text-align: center;"><img src="../legend/vtc_01_1_qualifyingforsupport0.png" /></td><td>qualifying for support</td></tr><tr><td style="text-align: center;"><img src="../legend/vtc_01_1_needofsupportbuteliminated1.png" /></td><td>need of support but eliminated</td></tr><tr><td style="text-align: center;"><img src="../legend/vtc_01_1_nottobeconsideredforsupport2.png" /></td><td>not to be considered for support</td></tr></table>': cluster_vtc_01_1,"OpenStreetMap": layer_OpenStreetMap_0,},{collapsed:false}).addTo(map);
	setBounds();
	var i = 0;
	layer_vtc_01_1.eachLayer(function(layer) {
		var context = {
			feature: layer.feature,
			variables: {}
		};
		layer.bindTooltip((layer.feature.properties['name'] !== null?String('<div style="color: #000000; font-size: 10pt; font-family: \'Chilanka\', sans-serif;">' + layer.feature.properties['name']) + '</div>':''), {permanent: true, offset: [-0, -16], className: 'css_vtc_01_1'});
		labels.push(layer);
		totalMarkers += 1;
		  layer.added = true;
		  addLabel(layer, i);
		  i++;
	});
	resetLabels([layer_vtc_01_1]);
	map.on("zoomend", function(){
		resetLabels([layer_vtc_01_1]);
	});
	map.on("layeradd", function(){
		resetLabels([layer_vtc_01_1]);
	});
	map.on("layerremove", function(){
		resetLabels([layer_vtc_01_1]);
	});
	console.log(json_vtc_01_1.features.length)

	function total(feature){
		var one = feature.properties.email === null;
		return one.features.length;
	};

	console.log(total(json_vtc_01_1))

	// inserting sums into html
	
	</script>
</body>
<script src="../assets/js/core/jquery.3.2.1.min.js"></script>
<script src="../assets/js/plugin/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script>
<script src="../assets/js/core/popper.min.js"></script>
<script src="../assets/js/core/bootstrap.min.js"></script>
<script src="../assets/js/plugin/chartist/chartist.min.js"></script>
<script src="../assets/js/plugin/chartist/plugin/chartist-plugin-tooltip.min.js"></script>
<script src="../assets/js/plugin/bootstrap-notify/bootstrap-notify.min.js"></script>
<script src="../assets/js/plugin/bootstrap-toggle/bootstrap-toggle.min.js"></script>
<script src="../assets/js/plugin/jquery-mapael/jquery.mapael.min.js"></script>
<script src="../assets/js/plugin/jquery-mapael/maps/world_countries.min.js"></script>
<script src="../assets/js/plugin/chart-circle/circles.min.js"></script>
<script src="../assets/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script>
<script src="../assets/js/ready.min.js"></script>
<script src="../assets/js/demo.js"></script>
</html>